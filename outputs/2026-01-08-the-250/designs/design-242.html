<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Core Slate - Neutral palette, natural spirit</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>

<!--
DESIGN: Core Slate - Neutral palette, natural spirit
ABOUTME: This design system implements tutorial_walkthrough with swiss_international aesthetics.
ABOUTME: Key characteristics: Precise grid-based layouts, neutral color palette with natural accents, playful interactive elements

QUICK START - Copy these variables to apply this design:
--color-primary: #6B9080;
--color-primary-light: #A4C3B2;
--color-background: #F6F7F2;
--color-surface: #FFFFFF;
--color-text: #2C3E3B;
--color-text-muted: #7A8987;
--color-border: #D6DBD8;
--color-success: #6B9080;
--color-code-bg: #EAF4F4;
--font-heading: 'Inter', system-ui, -apple-system, sans-serif;
--font-body: 'Inter', system-ui, -apple-system, sans-serif;
--font-mono: 'IBM Plex Mono', 'Courier New', monospace;
--radius-default: 4px;
--space-unit: 8px;

AESTHETIC PRINCIPLES:
1. Grid precision: All elements align to an 8px grid system for mathematical harmony
2. Neutral foundation with natural accents: Slate and sage colors evoke calm, earthy professionalism
3. Playful interactivity: Hover states and progress indicators add gentle delight to learning
4. Typography hierarchy: Clear contrast between headings, body, and code creates instant comprehension
5. Swiss objectivity meets real estate warmth: Clean structure with inviting, approachable tone

BEST FOR:
- Tutorial and onboarding experiences requiring clear step-by-step guidance
- Educational content for real estate professionals (property management, market analysis, etc.)
- Technical documentation that needs to feel approachable
- Multi-step processes with clear checkpoints and validation

AVOID IF:
- You need vibrant, attention-grabbing colors
- Your content is purely entertainment-focused
- You require maximum information density
- Traditional corporate formality is mandatory

FUNCTIONAL DIRECTION: tutorial_walkthrough
This design must clearly function as a tutorial_walkthrough. Required elements:
- Step-by-step panels with clear numbering and titles
- Code snippets with syntax highlighting
- Interactive try-it areas where users can practice
- Progress checkpoints showing completion status
- Navigation between tutorial steps
- Clear visual hierarchy showing current vs. completed vs. upcoming steps

DESIGN ERA: swiss_international
Swiss International Style principles applied:
- Mathematical grid system (8px base unit)
- Objective, neutral color palette
- Sans-serif typography (Inter for clean readability)
- Generous whitespace
- Functional hierarchy over decoration
- Precise alignment and spacing

EMOTIONAL TONE: playful
Achieved through:
- Friendly micro-interactions on hover
- Celebratory checkpoint completions
- Encouraging language in UI copy
- Subtle animations that don't distract
- Color accents that feel natural, not corporate

INDUSTRY: real_estate
Contextualized with:
- Natural, earthy color palette (sage greens, warm grays)
- Content themed around property analysis and market trends
- Icons and examples from real estate domain
- Professional yet approachable tone

COLOR MODE: both
This design supports both light and dark modes with proper contrast ratios.
Toggle available in top-right corner for user preference.
-->

<style>
:root {
    /* Core Colors - Light Mode */
    --color-primary: #6B9080;
    --color-primary-light: #A4C3B2;
    --color-primary-dark: #527563;
    --color-background: #F6F7F2;
    --color-surface: #FFFFFF;
    --color-surface-raised: #FFFFFF;
    --color-text: #2C3E3B;
    --color-text-muted: #7A8987;
    --color-border: #D6DBD8;
    --color-border-subtle: #E8ECEA;
    --color-success: #6B9080;
    --color-warning: #D4A574;
    --color-info: #7A9299;
    --color-code-bg: #EAF4F4;
    --color-code-text: #2C3E3B;
    --color-try-it-bg: #F0F7F4;
    --color-checkpoint-inactive: #E8ECEA;
    --color-checkpoint-active: #6B9080;
    --color-shadow: rgba(44, 62, 59, 0.08);

    /* Typography */
    --font-heading: 'Inter', system-ui, -apple-system, sans-serif;
    --font-body: 'Inter', system-ui, -apple-system, sans-serif;
    --font-mono: 'IBM Plex Mono', 'Courier New', monospace;

    /* Type Scale (1.25 - Major Third) */
    --text-xs: 0.64rem;
    --text-sm: 0.8rem;
    --text-base: 1rem;
    --text-lg: 1.25rem;
    --text-xl: 1.563rem;
    --text-2xl: 1.953rem;
    --text-3xl: 2.441rem;

    /* Spacing (8px grid) */
    --space-unit: 8px;
    --space-xs: calc(var(--space-unit) * 0.5);
    --space-sm: var(--space-unit);
    --space-md: calc(var(--space-unit) * 2);
    --space-lg: calc(var(--space-unit) * 3);
    --space-xl: calc(var(--space-unit) * 4);
    --space-2xl: calc(var(--space-unit) * 6);
    --space-3xl: calc(var(--space-unit) * 8);

    /* Shapes */
    --radius-sm: 2px;
    --radius-default: 4px;
    --radius-lg: 8px;
    --radius-full: 9999px;

    /* Shadows */
    --shadow-sm: 0 1px 2px var(--color-shadow);
    --shadow-default: 0 2px 8px var(--color-shadow);
    --shadow-lg: 0 4px 16px var(--color-shadow);

    /* Layout */
    --content-max-width: 1200px;
    --sidebar-width: 280px;
    --transition-speed: 0.2s;
}

[data-theme="dark"] {
    --color-primary: #A4C3B2;
    --color-primary-light: #C4D9CC;
    --color-primary-dark: #8FB09F;
    --color-background: #1A1F1E;
    --color-surface: #242A29;
    --color-surface-raised: #2E3534;
    --color-text: #E8ECEA;
    --color-text-muted: #9BA5A3;
    --color-border: #3A4241;
    --color-border-subtle: #2E3534;
    --color-success: #A4C3B2;
    --color-warning: #E3B98C;
    --color-info: #94AFB6;
    --color-code-bg: #1E2827;
    --color-code-text: #C4D9CC;
    --color-try-it-bg: #202726;
    --color-checkpoint-inactive: #3A4241;
    --color-checkpoint-active: #A4C3B2;
    --color-shadow: rgba(0, 0, 0, 0.3);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: var(--font-body);
    font-size: var(--text-base);
    line-height: 1.6;
    color: var(--color-text);
    background: var(--color-background);
    transition: background var(--transition-speed), color var(--transition-speed);
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-heading);
    font-weight: 600;
    line-height: 1.2;
    margin-bottom: var(--space-md);
    color: var(--color-text);
}

h1 { font-size: var(--text-3xl); }
h2 { font-size: var(--text-2xl); }
h3 { font-size: var(--text-xl); }
h4 { font-size: var(--text-lg); }

p {
    margin-bottom: var(--space-md);
}

code {
    font-family: var(--font-mono);
    font-size: 0.9em;
    background: var(--color-code-bg);
    color: var(--color-code-text);
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--radius-sm);
}

pre {
    background: var(--color-code-bg);
    color: var(--color-code-text);
    padding: var(--space-md);
    border-radius: var(--radius-default);
    overflow-x: auto;
    margin-bottom: var(--space-md);
    border: 1px solid var(--color-border);
}

pre code {
    background: none;
    padding: 0;
}

/* Layout Structure */
.tutorial-container {
    display: grid;
    grid-template-columns: var(--sidebar-width) 1fr;
    min-height: 100vh;
}

/* Sidebar - Step Navigation */
.sidebar {
    background: var(--color-surface);
    border-right: 1px solid var(--color-border);
    padding: var(--space-lg);
    position: sticky;
    top: 0;
    height: 100vh;
    overflow-y: auto;
}

.sidebar-header {
    margin-bottom: var(--space-xl);
}

.logo {
    font-size: var(--text-xl);
    font-weight: 700;
    color: var(--color-primary);
    margin-bottom: var(--space-xs);
}

.tutorial-title {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.step-list {
    list-style: none;
}

.step-item {
    margin-bottom: var(--space-sm);
}

.step-link {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    border-radius: var(--radius-default);
    text-decoration: none;
    color: var(--color-text-muted);
    transition: all var(--transition-speed);
    border: 1px solid transparent;
    font-size: var(--text-sm);
}

.step-link:hover {
    background: var(--color-background);
    color: var(--color-text);
}

.step-link.active {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary-dark);
}

.step-link.completed {
    color: var(--color-text);
}

.step-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border-radius: var(--radius-full);
    background: var(--color-checkpoint-inactive);
    color: var(--color-text-muted);
    font-size: var(--text-xs);
    font-weight: 600;
    flex-shrink: 0;
}

.step-link.active .step-number {
    background: white;
    color: var(--color-primary);
}

.step-link.completed .step-number {
    background: var(--color-checkpoint-active);
    color: white;
}

.step-link.completed .step-number::after {
    content: '✓';
}

.step-label {
    flex: 1;
}

/* Progress Bar */
.progress-section {
    margin-top: var(--space-xl);
    padding-top: var(--space-lg);
    border-top: 1px solid var(--color-border);
}

.progress-label {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    margin-bottom: var(--space-sm);
}

.progress-bar {
    height: 8px;
    background: var(--color-checkpoint-inactive);
    border-radius: var(--radius-full);
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--color-checkpoint-active);
    border-radius: var(--radius-full);
    width: 40%;
    transition: width 0.5s ease;
}

/* Main Content Area */
.main-content {
    padding: var(--space-xl);
    max-width: var(--content-max-width);
}

/* Header */
.content-header {
    margin-bottom: var(--space-2xl);
    padding-bottom: var(--space-lg);
    border-bottom: 2px solid var(--color-border);
}

.step-badge {
    display: inline-block;
    padding: var(--space-xs) var(--space-md);
    background: var(--color-primary-light);
    color: var(--color-primary-dark);
    border-radius: var(--radius-full);
    font-size: var(--text-sm);
    font-weight: 600;
    margin-bottom: var(--space-md);
}

.step-title {
    margin-bottom: var(--space-sm);
}

.step-description {
    font-size: var(--text-lg);
    color: var(--color-text-muted);
    margin-bottom: 0;
}

/* Theme Toggle */
.theme-toggle {
    position: fixed;
    top: var(--space-lg);
    right: var(--space-lg);
    width: 48px;
    height: 48px;
    border-radius: var(--radius-full);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    box-shadow: var(--shadow-default);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-speed);
    z-index: 1000;
}

.theme-toggle:hover {
    transform: scale(1.05);
    box-shadow: var(--shadow-lg);
}

.theme-toggle:active {
    transform: scale(0.95);
}

/* Content Sections */
.content-section {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-xl);
    margin-bottom: var(--space-lg);
}

.section-title {
    font-size: var(--text-xl);
    margin-bottom: var(--space-md);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.section-icon {
    width: 24px;
    height: 24px;
    color: var(--color-primary);
}

/* Code Snippet Component */
.code-snippet {
    position: relative;
    margin-bottom: var(--space-lg);
}

.code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-sm) var(--space-md);
    background: var(--color-surface-raised);
    border: 1px solid var(--color-border);
    border-bottom: none;
    border-radius: var(--radius-default) var(--radius-default) 0 0;
}

.code-language {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    font-family: var(--font-mono);
}

.copy-button {
    padding: var(--space-xs) var(--space-md);
    background: transparent;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    color: var(--color-text);
    font-size: var(--text-sm);
    cursor: pointer;
    transition: all var(--transition-speed);
    font-family: var(--font-body);
}

.copy-button:hover {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
}

.code-snippet pre {
    margin: 0;
    border-radius: 0 0 var(--radius-default) var(--radius-default);
    border-top: none;
}

/* Try It Area */
.try-it-area {
    background: var(--color-try-it-bg);
    border: 2px dashed var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-xl);
    margin-bottom: var(--space-lg);
}

.try-it-header {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    margin-bottom: var(--space-md);
}

.try-it-icon {
    width: 28px;
    height: 28px;
    color: var(--color-primary);
}

.try-it-title {
    font-size: var(--text-lg);
    font-weight: 600;
    margin: 0;
}

.try-it-input {
    width: 100%;
    padding: var(--space-md);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-default);
    color: var(--color-text);
    font-family: var(--font-mono);
    font-size: var(--text-base);
    margin-bottom: var(--space-md);
    resize: vertical;
    min-height: 120px;
}

.try-it-input:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(107, 144, 128, 0.1);
}

.try-it-actions {
    display: flex;
    gap: var(--space-sm);
}

.button {
    padding: var(--space-sm) var(--space-lg);
    border-radius: var(--radius-default);
    border: none;
    font-family: var(--font-body);
    font-size: var(--text-base);
    font-weight: 500;
    cursor: pointer;
    transition: all var(--transition-speed);
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    min-height: 44px;
}

.button-primary {
    background: var(--color-primary);
    color: white;
}

.button-primary:hover {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
    box-shadow: var(--shadow-default);
}

.button-primary:active {
    transform: translateY(0);
}

.button-secondary {
    background: var(--color-surface);
    color: var(--color-text);
    border: 1px solid var(--color-border);
}

.button-secondary:hover {
    background: var(--color-background);
    border-color: var(--color-primary);
}

/* Checkpoint Component */
.checkpoint {
    background: var(--color-surface-raised);
    border: 2px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-xl);
    margin-bottom: var(--space-lg);
}

.checkpoint.completed {
    border-color: var(--color-checkpoint-active);
    background: linear-gradient(to right, var(--color-surface-raised), var(--color-try-it-bg));
}

.checkpoint-header {
    display: flex;
    align-items: flex-start;
    gap: var(--space-md);
    margin-bottom: var(--space-md);
}

.checkpoint-icon {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-full);
    background: var(--color-checkpoint-inactive);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-weight: 700;
    color: var(--color-text-muted);
}

.checkpoint.completed .checkpoint-icon {
    background: var(--color-checkpoint-active);
    color: white;
}

.checkpoint-content h4 {
    margin-bottom: var(--space-xs);
}

.checkpoint-description {
    color: var(--color-text-muted);
    margin-bottom: 0;
}

.checkpoint-tasks {
    list-style: none;
    margin-top: var(--space-md);
}

.checkpoint-tasks li {
    padding: var(--space-sm) 0;
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.checkpoint-tasks li::before {
    content: '';
    width: 18px;
    height: 18px;
    border: 2px solid var(--color-border);
    border-radius: var(--radius-sm);
    flex-shrink: 0;
}

.checkpoint.completed .checkpoint-tasks li::before {
    background: var(--color-checkpoint-active);
    border-color: var(--color-checkpoint-active);
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
    background-size: 14px;
    background-position: center;
    background-repeat: no-repeat;
}

/* Info Box */
.info-box {
    background: var(--color-surface-raised);
    border-left: 4px solid var(--color-info);
    padding: var(--space-md);
    border-radius: var(--radius-default);
    margin-bottom: var(--space-lg);
}

.info-box-title {
    font-weight: 600;
    margin-bottom: var(--space-xs);
    color: var(--color-info);
}

.info-box p:last-child {
    margin-bottom: 0;
}

/* Navigation Buttons */
.step-navigation {
    display: flex;
    justify-content: space-between;
    gap: var(--space-md);
    margin-top: var(--space-2xl);
    padding-top: var(--space-xl);
    border-top: 1px solid var(--color-border);
}

.nav-button {
    padding: var(--space-md) var(--space-xl);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-default);
    color: var(--color-text);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    font-weight: 500;
    transition: all var(--transition-speed);
    min-height: 56px;
}

.nav-button:hover {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow-default);
}

.nav-button-next {
    margin-left: auto;
}

/* Responsive */
@media (max-width: 1024px) {
    .tutorial-container {
        grid-template-columns: 1fr;
    }

    .sidebar {
        position: relative;
        height: auto;
        border-right: none;
        border-bottom: 1px solid var(--color-border);
    }

    .main-content {
        padding: var(--space-lg);
    }
}

@media (max-width: 640px) {
    .main-content {
        padding: var(--space-md);
    }

    .content-section {
        padding: var(--space-md);
    }

    .step-navigation {
        flex-direction: column;
    }

    .nav-button-next {
        margin-left: 0;
    }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* Focus Styles */
*:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
}
</style>

<div class="tutorial-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">Core Slate</div>
            <div class="tutorial-title">Real Estate Analytics Tutorial</div>
        </div>

        <nav>
            <ul class="step-list">
                <li class="step-item">
                    <a href="#" class="step-link completed">
                        <span class="step-number">1</span>
                        <span class="step-label">Introduction to Market Analysis</span>
                    </a>
                </li>
                <li class="step-item">
                    <a href="#" class="step-link completed">
                        <span class="step-number">2</span>
                        <span class="step-label">Understanding Property Metrics</span>
                    </a>
                </li>
                <li class="step-item">
                    <a href="#" class="step-link active">
                        <span class="step-number">3</span>
                        <span class="step-label">Calculating Cap Rates</span>
                    </a>
                </li>
                <li class="step-item">
                    <a href="#" class="step-link">
                        <span class="step-number">4</span>
                        <span class="step-label">Comparative Market Analysis</span>
                    </a>
                </li>
                <li class="step-item">
                    <a href="#" class="step-link">
                        <span class="step-number">5</span>
                        <span class="step-label">Cash Flow Projections</span>
                    </a>
                </li>
                <li class="step-item">
                    <a href="#" class="step-link">
                        <span class="step-number">6</span>
                        <span class="step-label">Risk Assessment Models</span>
                    </a>
                </li>
                <li class="step-item">
                    <a href="#" class="step-link">
                        <span class="step-number">7</span>
                        <span class="step-label">Portfolio Optimization</span>
                    </a>
                </li>
                <li class="step-item">
                    <a href="#" class="step-link">
                        <span class="step-number">8</span>
                        <span class="step-label">Final Assessment</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="progress-section">
            <div class="progress-label">Tutorial Progress: 40%</div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <header class="content-header">
            <div class="step-badge">Step 3 of 8</div>
            <h1 class="step-title">Calculating Capitalization Rates</h1>
            <p class="step-description">Learn how to calculate and interpret cap rates for investment property analysis</p>
        </header>

        <!-- Introduction Section -->
        <section class="content-section">
            <h2 class="section-title">
                <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                What is a Cap Rate?
            </h2>

            <p>The <strong>capitalization rate</strong> (cap rate) is one of the most important metrics in real estate investing. It measures the rate of return on a real estate investment property based on the income that the property generates.</p>

            <p>Cap rate is expressed as a percentage and is calculated using the following formula:</p>

            <div class="info-box">
                <div class="info-box-title">Key Formula</div>
                <p><strong>Cap Rate = (Net Operating Income / Property Value) × 100</strong></p>
                <p>Where Net Operating Income (NOI) is annual income minus operating expenses, excluding mortgage payments.</p>
            </div>
        </section>

        <!-- Code Example -->
        <section class="content-section">
            <h2 class="section-title">
                <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="16 18 22 12 16 6"></polyline>
                    <polyline points="8 6 2 12 8 18"></polyline>
                </svg>
                Code Example
            </h2>

            <p>Here's a simple function to calculate cap rate in JavaScript:</p>

            <div class="code-snippet">
                <div class="code-header">
                    <span class="code-language">JavaScript</span>
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><code>function calculateCapRate(annualIncome, operatingExpenses, propertyValue) {
  // Calculate Net Operating Income
  const netOperatingIncome = annualIncome - operatingExpenses;

  // Calculate Cap Rate as percentage
  const capRate = (netOperatingIncome / propertyValue) * 100;

  return {
    noi: netOperatingIncome,
    capRate: capRate.toFixed(2) + '%',
    quality: interpretCapRate(capRate)
  };
}

function interpretCapRate(rate) {
  if (rate < 4) return 'Low (Premium Property)';
  if (rate < 8) return 'Moderate (Stable Investment)';
  if (rate < 12) return 'High (Value-Add Opportunity)';
  return 'Very High (High Risk)';
}

// Example usage
const analysis = calculateCapRate(120000, 45000, 1000000);
console.log(`Cap Rate: ${analysis.capRate}`);
console.log(`NOI: $${analysis.noi.toLocaleString()}`);
console.log(`Quality: ${analysis.quality}`);</code></pre>
            </div>
        </section>

        <!-- Try It Area -->
        <section class="content-section">
            <div class="try-it-area">
                <div class="try-it-header">
                    <svg class="try-it-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
                    </svg>
                    <h3 class="try-it-title">Try It Yourself</h3>
                </div>

                <p>Modify the values below and click "Calculate" to see the cap rate in action:</p>

                <textarea class="try-it-input" placeholder="Paste the code above and modify the values...">const myAnalysis = calculateCapRate(150000, 55000, 1250000);
console.log(`Cap Rate: ${myAnalysis.capRate}`);
console.log(`NOI: $${myAnalysis.noi.toLocaleString()}`);
console.log(`Investment Quality: ${myAnalysis.quality}`);</textarea>

                <div class="try-it-actions">
                    <button class="button button-primary" onclick="runCode()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        Run Code
                    </button>
                    <button class="button button-secondary" onclick="resetCode()">Reset</button>
                </div>
            </div>
        </section>

        <!-- Real World Example -->
        <section class="content-section">
            <h2 class="section-title">
                <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                Real-World Example
            </h2>

            <p>Let's analyze a real property scenario:</p>

            <div class="info-box">
                <p><strong>Property:</strong> 24-unit apartment building in suburban market</p>
                <p><strong>Purchase Price:</strong> $3,200,000</p>
                <p><strong>Gross Annual Income:</strong> $456,000 (all units rented)</p>
                <p><strong>Operating Expenses:</strong> $164,000 (property management, maintenance, insurance, taxes)</p>
            </div>

            <div class="code-snippet">
                <div class="code-header">
                    <span class="code-language">Calculation</span>
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><code>Net Operating Income = $456,000 - $164,000 = $292,000

Cap Rate = ($292,000 / $3,200,000) × 100 = 9.13%

Interpretation: This 9.13% cap rate suggests a strong value-add
opportunity with moderate risk. The property is generating healthy
returns above typical institutional-grade assets (4-6% cap rates)
but isn't in the high-risk category (12%+).</code></pre>
            </div>
        </section>

        <!-- Checkpoint -->
        <div class="checkpoint completed">
            <div class="checkpoint-header">
                <div class="checkpoint-icon">✓</div>
                <div class="checkpoint-content">
                    <h4>Checkpoint: Understanding Cap Rates</h4>
                    <p class="checkpoint-description">Complete these tasks to verify your understanding before moving on.</p>
                </div>
            </div>

            <ul class="checkpoint-tasks">
                <li>Calculate NOI from gross income and expenses</li>
                <li>Apply the cap rate formula correctly</li>
                <li>Interpret cap rate percentages (low vs. high)</li>
                <li>Understand the inverse relationship between cap rate and property value</li>
            </ul>
        </div>

        <!-- Key Takeaways -->
        <section class="content-section">
            <h2 class="section-title">
                <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
                Key Takeaways
            </h2>

            <ul>
                <li><strong>Cap rate is income-focused:</strong> It measures returns based on property income, not appreciation potential.</li>
                <li><strong>Higher isn't always better:</strong> High cap rates often indicate higher risk or less desirable locations.</li>
                <li><strong>Market comparison matters:</strong> Compare cap rates within the same market and property type.</li>
                <li><strong>Cap rate excludes financing:</strong> The calculation doesn't consider mortgage terms or debt service.</li>
                <li><strong>NOI is the foundation:</strong> Accurate expense estimates are critical for meaningful cap rate analysis.</li>
            </ul>
        </section>

        <!-- Navigation -->
        <nav class="step-navigation">
            <a href="#" class="nav-button nav-button-prev">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
                Previous: Property Metrics
            </a>
            <a href="#" class="nav-button nav-button-next">
                Next: Market Analysis
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                    <polyline points="12 5 19 12 12 19"></polyline>
                </svg>
            </a>
        </nav>
    </main>
</div>

<!-- Theme Toggle Button -->
<button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
    </svg>
</button>

<script>
// Theme Toggle
function toggleTheme() {
    const html = document.documentElement;
    const currentTheme = html.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    html.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
}

// Load saved theme
const savedTheme = localStorage.getItem('theme') || 'light';
document.documentElement.setAttribute('data-theme', savedTheme);

// Copy Code Function
function copyCode(button) {
    const codeBlock = button.closest('.code-snippet').querySelector('code');
    const text = codeBlock.textContent;

    navigator.clipboard.writeText(text).then(() => {
        const originalText = button.textContent;
        button.textContent = 'Copied!';
        setTimeout(() => {
            button.textContent = originalText;
        }, 2000);
    });
}

// Simulate Run Code
function runCode() {
    alert('In a real application, this would execute the code in a sandboxed environment.\n\nFor this demo:\nCap Rate: 7.60%\nNOI: $95,000\nInvestment Quality: Moderate (Stable Investment)');
}

// Reset Code
function resetCode() {
    const textarea = document.querySelector('.try-it-input');
    textarea.value = `const myAnalysis = calculateCapRate(150000, 55000, 1250000);
console.log(\`Cap Rate: \${myAnalysis.capRate}\`);
console.log(\`NOI: $\${myAnalysis.noi.toLocaleString()}\`);
console.log(\`Investment Quality: \${myAnalysis.quality}\`);`;
}

// Keyboard Navigation for Tutorial Steps

function navigateDesign(direction) {
    const TOTAL = 250;
    const CURRENT = 242;

    let nextId;
    if (direction === 'prev') {
        nextId = CURRENT > 1 ? CURRENT - 1 : TOTAL;
    } else {
        nextId = CURRENT < TOTAL ? CURRENT + 1 : 1;
    }

    window.location.href = `design-${nextId}.html`;
}
</script>

</body>
</html>